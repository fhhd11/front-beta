# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –±—ç–∫–µ–Ω–¥–æ–º etrnl.chat

## üöÄ –û–±–∑–æ—Ä –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ç–µ–ø–µ—Ä—å –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ —Å –≤–∞—à–∏–º –±—ç–∫–µ–Ω–¥–æ–º –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ, –≤–∫–ª—é—á–∞—è `letta_agent_id` –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å AI-–∞–≥–µ–Ω—Ç–æ–º.

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env.local` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```env
# Supabase Configuration
VITE_SUPABASE_URL=https://your-project.supabase.co
VITE_SUPABASE_ANON_KEY=your-supabase-anon-key

# Backend API Configuration
VITE_API_BASE_URL=http://localhost:8000
```

### 2. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ API

–í–∞—à –±—ç–∫–µ–Ω–¥ –¥–æ–ª–∂–µ–Ω –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:

#### GET /api/v1/me
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ:

```json
{
  "id": "user-uuid",
  "email": "user@example.com",
  "name": "–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
  "letta_agent_id": "agent-uuid",
  "created_at": "2024-01-01T00:00:00Z",
  "updated_at": "2024-01-01T00:00:00Z"
}
```

#### GET /api/v1/agent
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –∞–≥–µ–Ω—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:

```json
{
  "id": "agent-uuid",
  "name": "–ú–æ–π AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç",
  "status": "active",
  "created_at": "2024-01-01T00:00:00Z"
}
```

## üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

### JWT —Ç–æ–∫–µ–Ω—ã
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç JWT —Ç–æ–∫–µ–Ω—ã –∏–∑ Supabase
- –¢–æ–∫–µ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å—Ç–µ—á–µ–Ω–∏—è —Å–µ—Å—Å–∏–π

### –ó–∞–≥–æ–ª–æ–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
```javascript
{
  'Authorization': 'Bearer <supabase-jwt-token>',
  'Content-Type': 'application/json'
}
```

## üì± –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è
- ‚úÖ –ü—Ä–∏ –≤—Ö–æ–¥–µ –≤ —Å–∏—Å—Ç–µ–º—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è `letta_agent_id` –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞–≥–µ–Ω—Ç–µ –≤ UI

### –°–æ—Å—Ç–æ—è–Ω–∏–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
```javascript
import { useAuth } from '@/composables/useAuth.js'

const {
  user,           // Supabase user object
  userProfile,    // Extended user info from backend
  lettaAgentId,   // User's Letta agent ID
  isAuthenticated, // Auth status
  hasAgent,       // Whether user has an agent
  userName,       // Display name
  userEmail       // User email
} = useAuth()
```

### –†–∞–±–æ—Ç–∞ —Å –∞–≥–µ–Ω—Ç–æ–º
```javascript
import { useAgent } from '@/composables/useAgent.js'

const {
  agentInfo,      // Agent information
  agentId,        // Agent ID
  agentName,      // Agent display name
  agentStatus,    // Agent status (active, inactive, training)
  isAgentReady,   // Whether agent is ready for interaction
  loadAgentInfo   // Function to load agent info
} = useAgent()
```

## üé® UI –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
–í –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É —á–∞—Ç–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è:
- ‚úÖ –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ Email
- ‚úÖ –°—Ç–∞—Ç—É—Å –∞–≥–µ–Ω—Ç–∞ (—Å —Ü–≤–µ—Ç–æ–≤—ã–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–º)
- ‚úÖ –ò–º—è –∞–≥–µ–Ω—Ç–∞
- ‚úÖ –°–æ–∫—Ä–∞—â–µ–Ω–Ω—ã–π Agent ID

### –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã —Å—Ç–∞—Ç—É—Å–∞ –∞–≥–µ–Ω—Ç–∞
- üü¢ **–ó–µ–ª–µ–Ω—ã–π** - –∞–≥–µ–Ω—Ç –∞–∫—Ç–∏–≤–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ
- üü° **–ñ–µ–ª—Ç—ã–π** - –∞–≥–µ–Ω—Ç –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–±—É—á–µ–Ω–∏—è
- üî¥ **–ö—Ä–∞—Å–Ω—ã–π** - –∞–≥–µ–Ω—Ç –Ω–µ–∞–∫—Ç–∏–≤–µ–Ω
- ‚ö™ **–°–µ—Ä—ã–π** - —Å—Ç–∞—Ç—É—Å –Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω

## üîÑ –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

### 1. –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É
```
Supabase Auth ‚Üí –ü–æ–ª—É—á–µ–Ω–∏–µ JWT ‚Üí –ó–∞–ø—Ä–æ—Å /api/v1/me ‚Üí –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ letta_agent_id
```

### 2. –ó–∞–≥—Ä—É–∑–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –∞–≥–µ–Ω—Ç–µ
```
–ü—Ä–æ–≤–µ—Ä–∫–∞ letta_agent_id ‚Üí –ó–∞–ø—Ä–æ—Å /api/v1/agent ‚Üí –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ UI
```

### 3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
```
Auth state change ‚Üí –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è ‚Üí –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
```

## üõ†Ô∏è API –∫–ª–∏–µ–Ω—Ç

### –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å
```javascript
import { apiClient } from '@/api/client.js'

// GET –∑–∞–ø—Ä–æ—Å
const { data, error } = await apiClient.get('/api/v1/me')

// POST –∑–∞–ø—Ä–æ—Å
const { data, error } = await apiClient.post('/api/v1/chat/message', {
  message: 'Hello',
  agent_id: lettaAgentId.value
})
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
```javascript
import { ApiError } from '@/api/client.js'

try {
  const { data, error } = await apiClient.get('/api/v1/me')
} catch (error) {
  if (error instanceof ApiError) {
    if (error.isAuthError()) {
      // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
    } else if (error.isNetworkError()) {
      // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–æ–∫
    }
  }
}
```

## üìä –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ API –∑–∞–ø—Ä–æ—Å—ã –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏:
- ‚úÖ –£—Å–ø–µ—à–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- ‚úÖ –û—à–∏–±–∫–∏ API
- ‚úÖ –°–æ—Å—Ç–æ—è–Ω–∏–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## üö® –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –¢–∏–ø—ã –æ—à–∏–±–æ–∫
- **401 Unauthorized** - —Å–µ—Å—Å–∏—è –∏—Å—Ç–µ–∫–ª–∞
- **403 Forbidden** - –Ω–µ—Ç –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
- **404 Not Found** - —Ä–µ—Å—É—Ä—Å –Ω–µ –Ω–∞–π–¥–µ–Ω
- **422 Validation Error** - –æ—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- **5xx Server Error** - –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
- **Network Error** - –ø—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ç—å—é

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
–í—Å–µ –æ—à–∏–±–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ —Å –ø–æ–Ω—è—Ç–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏.

## üîÆ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –ì–æ—Ç–æ–≤–æ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:
1. **–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π** —á–µ—Ä–µ–∑ `/api/v1/chat/message`
2. **–ü–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏** —á–µ—Ä–µ–∑ `/api/v1/chat/messages`
3. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é** –∞–≥–µ–Ω—Ç–∞
4. **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–≥–µ–Ω—Ç–∞**

### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è letta_agent_id:
```javascript
// –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –∞–≥–µ–Ω—Ç—É
const sendMessage = async (message) => {
  const { data, error } = await apiClient.post('/api/v1/chat/message', {
    message,
    agent_id: lettaAgentId.value
  })
}
```

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [API Client Documentation](./src/api/client.js)
- [Auth Composable](./src/composables/useAuth.js)
- [Agent Composable](./src/composables/useAgent.js)
- [API Configuration](./src/config/api.js)
